## 基于机器学习模型的文学作品评论过滤系统：

- ### 违规评论的定义：

  - 垃圾信息：广告、链接或宣传信息，以推销产品、服务或网站为目的的评论
  - 恶意评论：包括辱骂、诽谤、歧视、仇恨言论等，旨在伤害或羞辱他人的评论
  - 无意义评论：与主题无关的评论，通常只是一些随机字符、表情符号或毫无意义的话语

- ### 分类问题：

  - 评论分类问题属于二分类问题，两个困难点在于：
    - 短文本提供的词语少，提供的有效信息有限
    - 根据分词结果构建的词频或者特征矩阵通常十分稀疏，大多数算法在处理稀疏矩阵问题时候，效果都不好
    - 存在明显的数据不平衡问题，正常评论样本往往远多于垃圾评论
  - 常用的处理短文本的方法基本可分为两类：
    - 基于某种规则改进分类过程，优化改进模型
    - 基于外部语义信息扩充短文本信息量，从而提高分类效果

- ### 实现过程

  - 数据预处理
    
    - 正则匹配，去除数字、非字符数字和下划线
    - 分词：jieba分词器
    - 停词
    - 数据标准化，句子分词后用空格隔开，形成文本列表
    - 样本数量：50万条左右

  - 特征提取(基于TF-IDF算法)

    - 使用sklearn库中的TfidfVectorizer类来实现特征提取

    - ```python
      ('vect', TfidfVectorizer(token_pattern=r"(?u)\b\w+\b"))
      ```

    - 作为流水线的一环，接受数据预处理后的文本列表，并计算出每个词的TF-IDF值，并输出一个稀疏的特征向量矩阵，作为特征选择的输入

    - 参数max_df，词语在句子中出现的最大有效频率，需要通过网格搜索与交叉验证得出最优解

  - CHI特征选择

    - 使用sklearn中的chi2类来实现卡方检验

    - ```python
      ('chi2', SelectKBest(chi2))
      ```

    - 使用selectBest选择器对特征向量矩阵进行特征选择，最优保留特征数量k，需要通过网格搜索和交叉验证得出

    - 同样集成到流水线模型中

  - 训练分类器

    - 采用支持向量机的监督式二元分类器（linear内核的svc）
    - 将训练数据中的一些子集从被称为支持向量的剩余部分分离
    - 预测测试数据类型的支持向量机模型的决策树基于支持向量，并且利用了核技巧
    - SVC模型通过网格搜索与交叉验证的方式得到最优的惩罚系数C
    - 集成了流水线模型，将数据预处理、特征提取、特征选择一同集成到了模型中

  - 保存模型

    > ```
    > with open('svm_model.pickle', 'wb') as fw:
    >    pickle.dump(best_model, fw)
    > ```

  - 在测试集上训练，计算模型的准确率与召回率

  

